

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reusing Compiled JSON Files &mdash; JsonQL 1.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=61243dd2"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Sample Files" href="../SampleFiles/index.html" />
    <link rel="prev" title="Error Details" href="../ErrorDetails/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            JsonQL
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Mutating JSON Files</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../ImportantInterfaces/ICompilationResult/index.html">Result Data Structure: JsonQL.Compilation.ICompilationResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ErrorDetails/index.html">Error Details</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Reusing Compiled JSON Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SampleFiles/index.html">Sample Files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../QueryingJsonFiles/index.html">Querying JSON Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../LambdaFunctions/index.html">Lambda Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../SpecialKeywords/index.html">Special Keywords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JsonMutatorOperators/index.html">JSON Mutator Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JsonPathFunctions/index.html">JSON Path Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Functions/index.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../AggregateFunctions/index.html">Aggregate Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Operators/index.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../OptionalAndNamedParameters/index.html">Optional and Named Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DependencyInjectionSetup/index.html">Dependency Injection Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CustomJsonQL/index.html">Custom JsonQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../FutureReleases/index.html">Future Releases</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">JsonQL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Mutating JSON Files</a></li>
      <li class="breadcrumb-item active">Reusing Compiled JSON Files</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/MutatingJsonFiles/ReusingCompiledJsonFiles/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="reusing-compiled-json-files">
<h1>Reusing Compiled JSON Files<a class="headerlink" href="#reusing-compiled-json-files" title="Link to this heading"></a></h1>
<p>Example in code snippet below is copied from section <a class="reference internal" href="../index.html"><span class="doc">Mutating JSON Files</span></a> and uses one of overladed methods <strong>ICompilationResult Compile(IJsonTextData jsonTextData)</strong> in interface <a class="reference external" href="https://github.com/artakhak/JsonQL/blob/main/JsonQL/Compilation/IJsonCompiler.cs">JsonQL.Compilation.IJsonCompiler</a> to parse <strong>“Example.json</strong>.
This example also parses parent JSON files <strong>Parameters.json</strong>, <strong>Countries</strong>, <strong>Companies</strong>, <strong>FilteredCompanies</strong>.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="n">sharedExamplesFolderPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;DocFiles&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MutatingJsonFiles&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Examples&quot;</span><span class="p">};</span>

<span class="kt">var</span><span class="w"> </span><span class="n">parametersJsonTextData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JsonTextData</span><span class="p">(</span><span class="s">&quot;Parameters&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">LoadJsonFileHelpers</span><span class="p">.</span><span class="n">LoadJsonFile</span><span class="p">(</span><span class="s">&quot;Parameters.json&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sharedExamplesFolderPath</span><span class="p">));</span>

<span class="c1">// countriesJsonTextData uses parametersJsonTextData for parameter parentJsonTextData</span>
<span class="kt">var</span><span class="w"> </span><span class="n">countriesJsonTextData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JsonTextData</span><span class="p">(</span><span class="s">&quot;Countries&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">LoadJsonFileHelpers</span><span class="p">.</span><span class="n">LoadJsonFile</span><span class="p">(</span><span class="s">&quot;Countries.json&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sharedExamplesFolderPath</span><span class="p">),</span><span class="w"> </span><span class="n">parametersJsonTextData</span><span class="p">);</span>

<span class="kt">var</span><span class="w"> </span><span class="n">companiesJsonTextData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JsonTextData</span><span class="p">(</span><span class="s">&quot;Companies&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">LoadJsonFileHelpers</span><span class="p">.</span><span class="n">LoadJsonFile</span><span class="p">(</span><span class="s">&quot;Companies.json&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sharedExamplesFolderPath</span><span class="p">),</span><span class="w"> </span><span class="n">countriesJsonTextData</span><span class="p">);</span>

<span class="kt">var</span><span class="w"> </span><span class="n">filteredCompaniesJsonTextData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JsonTextData</span><span class="p">(</span><span class="s">&quot;FilteredCompanies&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">LoadJsonFileHelpers</span><span class="p">.</span><span class="n">LoadJsonFile</span><span class="p">(</span><span class="s">&quot;FilteredCompanies.json&quot;</span><span class="p">,</span><span class="w">  </span><span class="n">sharedExamplesFolderPath</span><span class="p">),</span><span class="w"> </span><span class="n">companiesJsonTextData</span><span class="p">);</span>

<span class="c1">// Set the value of jsonCompiler to an instance of JsonQL.Compilation.IJsonCompiler here.</span>
<span class="c1">// The value of JsonQL.Compilation.JsonCompiler is normally created by Dependency Injection container</span>
<span class="c1">// and it is normally configured as a singleton.</span>
<span class="n">JsonQL</span><span class="p">.</span><span class="n">Compilation</span><span class="p">.</span><span class="n">IJsonCompiler</span><span class="w"> </span><span class="n">jsonCompiler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="o">!</span><span class="p">;</span>

<span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonCompiler</span><span class="p">.</span><span class="n">Compile</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">JsonTextData</span><span class="p">(</span><span class="s">&quot;Example&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">LoadExampleJsonFile</span><span class="p">(</span><span class="s">&quot;Example.json&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">filteredCompaniesJsonTextData</span><span class="p">));</span>
</pre></div>
</div>
<p>Now consider scenario when we want to reuse all or some of compiled parent JSON files to parse some other JSON file.
We could use the same method as above, however doing this would result in parent JSON files being compiled again.
To re-use the compiled parent JSON files without compiling them again we can call the <strong>ICompilationResult Compile(IJsonTextData jsonTextData)</strong> method to compile only parent JSON files,
and then use another overloaded version <strong>ICompilationResult Compile(string jsonText, string jsonTextIdentifier, IReadOnlyList&lt;ICompiledJsonData&gt; compiledParents)</strong> of that method which takes <strong>IReadOnlyList&lt;ICompiledJsonData&gt; compiledParents</strong> instead of <strong>IJsonTextData jsonTextData</strong> as a parameter.</p>
<p>Here is a code snippet demonstrating this approach:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="n">sharedExamplesFolderPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;DocFiles&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MutatingJsonFiles&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Examples&quot;</span><span class="p">};</span>

<span class="kt">var</span><span class="w"> </span><span class="n">parametersJsonTextData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JsonTextData</span><span class="p">(</span><span class="s">&quot;Parameters&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="n">LoadExampleJsonFile</span><span class="p">(</span><span class="s">&quot;Parameters.json&quot;</span><span class="p">));</span>

<span class="c1">// countriesJsonTextData uses parametersJsonTextData for parameter parentJsonTextData</span>
<span class="kt">var</span><span class="w"> </span><span class="n">countriesJsonTextData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JsonTextData</span><span class="p">(</span><span class="s">&quot;Countries&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">LoadJsonFileHelpers</span><span class="p">.</span><span class="n">LoadJsonFile</span><span class="p">(</span><span class="s">&quot;Countries.json&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">_sharedExamplesFolderPath</span><span class="p">),</span><span class="w"> </span><span class="n">parametersJsonTextData</span><span class="p">);</span>

<span class="kt">var</span><span class="w"> </span><span class="n">companiesJsonTextData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JsonTextData</span><span class="p">(</span><span class="s">&quot;Companies&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">LoadJsonFileHelpers</span><span class="p">.</span><span class="n">LoadJsonFile</span><span class="p">(</span><span class="s">&quot;Companies.json&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">_sharedExamplesFolderPath</span><span class="p">),</span><span class="w"> </span><span class="n">countriesJsonTextData</span><span class="p">);</span>

<span class="c1">// Set the value of jsonCompiler to an instance of JsonQL.Compilation.IJsonCompiler here.</span>
<span class="c1">// The value of JsonQL.Compilation.IJsonCompiler is normally created by Dependency Injection container</span>
<span class="c1">// and it is normally configured as a singleton.</span>
<span class="n">JsonQL</span><span class="p">.</span><span class="n">Compilation</span><span class="p">.</span><span class="n">IJsonCompiler</span><span class="w"> </span><span class="n">jsonCompiler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="o">!</span><span class="p">;</span>

<span class="kt">var</span><span class="w"> </span><span class="n">cachedCompilationResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonCompiler</span><span class="p">.</span><span class="n">Compile</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">JsonTextData</span><span class="p">(</span><span class="s">&quot;FilteredCompanies&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="n">LoadExampleJsonFile</span><span class="p">(</span><span class="s">&quot;FilteredCompanies.json&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">companiesJsonTextData</span><span class="p">));</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cachedCompilationResult</span><span class="p">.</span><span class="n">CompilationErrors</span><span class="p">.</span><span class="n">Count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ApplicationException</span><span class="p">(</span><span class="s">&quot;Compilation failed&quot;</span><span class="p">);</span>

<span class="kt">var</span><span class="w"> </span><span class="n">compiledParents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">ICompiledJsonData</span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">cachedCompilationResult</span><span class="p">.</span><span class="n">CompiledJsonFiles</span><span class="p">.</span><span class="n">First</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">TextIdentifier</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Companies&quot;</span><span class="p">)</span>
<span class="p">};</span>

<span class="kt">var</span><span class="w"> </span><span class="n">jsonThatDependsOnCompanies</span><span class="w"> </span><span class="o">=</span>
<span class="w">       </span><span class="kt">string</span><span class="p">.</span><span class="n">Concat</span><span class="p">(</span>
<span class="w">       </span><span class="s">&quot;{\&quot;AllCompanyNames:\&quot;: \&quot;$value(Companies.Select(x =&gt; x.CompanyData.Name))\&quot;,&quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="s">&quot;\&quot;AllCompanyEmployees:\&quot;: \&quot;$value(Companies.Where(x =&gt; !(x.CompanyData.Name starts with &#39;Strange&#39;)).Select(x =&gt; x.Employees))\&quot;}&quot;</span><span class="p">);</span>

<span class="c1">// Compile jsonThatDependsOnCompanies JSON using only compiled &quot;Companies.json&quot; as parents (in compiledParents)</span>
<span class="kt">var</span><span class="w"> </span><span class="n">jsonThatDependsOnCompaniesResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonCompiler</span><span class="p">.</span><span class="n">Compile</span><span class="p">(</span><span class="n">jsonThatDependsOnCompanies</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Json1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">compiledParents</span><span class="p">);</span>
<span class="c1">// Do something with jsonThatDependsOnCompaniesResult here.</span>

<span class="c1">// NOTE: The list of parents compiledParents passed to _jsonCompiler.Compile() is organized in such a way</span>
<span class="c1">// that child JSON files appear earlier, and parent JSON files appear later.</span>
<span class="c1">// In this example &quot;Example.json&quot; will be treated as a child of &quot;FilteredCompanies&quot;, &quot;FilteredCompanies&quot; will be treated as a child of</span>
<span class="c1">// &quot;Companies&quot; and so forth.</span>
<span class="c1">// This relationship will ensure that JSON objects referenced in JsonQL expressions in &quot;Example.json&quot; will</span>
<span class="c1">// be looked up first in &quot;Example.json&quot;, then in &quot;FilteredCompanies&quot;, and so forth.</span>
<span class="n">compiledParents</span><span class="w"> </span><span class="o">=</span>
<span class="na">[</span>
<span class="na">    cachedCompilationResult.CompiledJsonFiles.First(x =&gt; x.TextIdentifier == &quot;FilteredCompanies&quot;),</span>
<span class="na">    cachedCompilationResult.CompiledJsonFiles.First(x =&gt; x.TextIdentifier == &quot;Companies&quot;),</span>
<span class="na">    cachedCompilationResult.CompiledJsonFiles.First(x =&gt; x.TextIdentifier == &quot;Countries&quot;),</span>
<span class="na">    cachedCompilationResult.CompiledJsonFiles.First(x =&gt; x.TextIdentifier == &quot;Parameters&quot;)</span>
<span class="na">]</span><span class="p">;</span>

<span class="c1">// Compile jsonThatDependsOnCompanies JSON using all four compiled JSON files as parents (in compiledParents)</span>
<span class="kt">var</span><span class="w"> </span><span class="n">exampleJsonResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonCompiler</span><span class="p">.</span><span class="n">Compile</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">LoadExampleJsonFile</span><span class="p">(</span><span class="s">&quot;Example.json&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">compiledParents</span><span class="p">);</span>
<span class="c1">// Do something with exampleJsonResult here.</span>
</pre></div>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>In this example we do the following:</dt><dd><ul>
<li><p>Compile parent JSON files and store the result in <strong>cachedCompilationResult</strong></p></li>
<li><p>Compile a child JSON in variable <strong>jsonThatDependsOnCompanies</strong> by passing collection of <strong>JsonQL.JsonObjects.JsonQL.Compilation</strong> retrieved from <strong>cachedCompilationResult</strong> for only <strong>Companies.json</strong> as parents.</p></li>
<li><p>Compile a child JSON in file <strong>Example.json</strong> by passing collection of <strong>JsonQL.JsonObjects.JsonQL.Compilation</strong> retrieved from <strong>cachedCompilationResult</strong> for <strong>Parameters</strong>, <strong>Companies.json</strong>, <strong>Companies</strong>, <strong>FilteredCompanies</strong> as parents, since JsonQL expressions in <strong>Example.json</strong> depend on JSON objects in all these fies.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../ErrorDetails/index.html" class="btn btn-neutral float-left" title="Error Details" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../SampleFiles/index.html" class="btn btn-neutral float-right" title="Sample Files" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Artak Hakobyan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>